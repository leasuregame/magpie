# 战报

战报是服务器发放战斗过程的传输格式，客户端用来演示战斗过程。
战报必须满足无须其他任何数据只要拿到战报就能完整地播放一场战斗的要求。

战报以json格式保存数据。现在为了满足网页版jsonp的要求，战报内容存放在callback()括号中。

获取战报时需要提供的参数：
* 我方玩家ID
* 敌方玩家ID
* 我方阵容（长度为6的数组，对应1～6个位置，内容为每张上阵卡牌对应的数据库ID，该ID在进入游戏时获得）

战报json数据主要包含一下内容:

    {
  own : object,     // 己方战斗信息
  enemy : object,     // 敌方战斗信息
  winner : own or enemy,    // 胜利方，己方或敌方
  rewards : object,   // 战斗奖励，具体待定
  steps : array     // 战斗步骤，包含真个战斗流程的数组
    }

own 节点，存放己方的这场战斗的战斗信息，包括玩家名，玩家等级，阵容配置。格式如下：

    own : {
  name : string,      // 玩家名
  lv : number,      // 玩家等级
  cards : array     // 玩家阵容，一个长度为6的数组，代表0～5号位的卡牌，若一个位子不存在卡牌，则为      null
    }

enemy 节点，存放敌方的这场战斗的战斗信息，包括玩家名，玩家等级，阵容配置。格式如下：
    
    enemy : {
  name : string,      // 玩家名
  lv : number,      // 玩家等级
  cards : array     // 玩家阵容，一个长度为6的数组，代表0～5号位的卡牌，若一个位子不存在卡牌，则为null
    }

cards 节点，存放一个长度为6的数组，对应6个阵容位子。格式如下：

    cards : [
  { // 现阶段其实只需要卡牌对应数据表的id号和hp
    // 根据id可以新建一张卡牌的形象，hp用于计算血条
    // 附加的lv, atk以后可能会用到，比如战斗后的阵容比较
    id : number,    // 卡牌对应配表id
    lv : number,    // 卡牌等级
    hp : number,    // 卡牌血量
    atk : number    // 卡牌攻击
  },

  object,

  // 后续的节点同上
  // 如果某个位子没有放置卡牌则该点为null
  // 长度一定为6
    ]

winner 节点，存放own或者enemy，表示这场战斗的胜利者。格式如下：
winner : "own" / "enemy"

rewards 节点，存放战斗所获得的奖励，格式待定。

steps 节点， 是一个数组，存放战斗过程的每个步骤。一个步骤为一个回合中某个卡牌的一次出手。
一次出手由一下几个条件组成：
1、 攻击者
2、 攻击类型： 技能 或者 普攻
3、 被作用者
4、 作用效果：伤害 加血 暴击 闪避

格式如下：
    
    steps : [
  {
    a : number,     // 出击单位ID号“0～11”，正代表普攻，负代表技能，只有一个出击卡牌
    d : number or array,  // 受击单位ID号“0～11”，正代表非暴击，负代表暴击， 可以有多个受击卡牌
    e : number or array,  // 受击单位伤害值，0代表闪避，正代表加血，负代表伤害
  },

  object,

  // 后续的节点同上
  // 长度不固定
    ]

### 战报例子：

    {
    own: {
        name: "haha", // 玩家名
        lv: 51, // 玩家等级
        cards: [{
                id: 1,
                lv: 50,
                hp: 30000,
                atk: 1200
            },

            null,

            null,

            null,

            null,

            null

            // 后续的节点同上
            // 长度一定为6
        ]
    },

    enemy: {
        name: "xixi", // 玩家名
        lv: 52, // 玩家等级
        cards: [{
                id: 2,
                lv: 49,
                hp: 20000,
                atk: 2000
            },

            null,

            null,

            null,

            null,

            null

            // 后续的节点同上
            // 如果某个位子没有放置卡牌则该点为null
            // 长度一定为6
        ]
    },

    winner: own, // 胜利方，己方或敌方

    rewards: object, // 战斗奖励，具体待定

    steps: [{
            a: -3, // 出击单位ID号“0～11”，正代表普攻，负代表技能，只有一个出击卡牌
            d: [-6, 7, 10], // 受击单位ID号“0～11”，正代表非暴击，负代表暴击， 可以有多个受击卡牌
            e: [3000, 0, 2000], // 受击单位伤害值，0代表闪避，正代表加血，负代表伤害
        },
        // 后续的节点同上
        // 长度不固定
    ]
    }


传输格式：
尽量减少不必要的字符，以达到缩减战报，更快地传输数据。

    {
    o: {
        n: "haha", // 玩家名
        l: 51, // 玩家等级
        c: [{
                d : number,   // 卡牌对应配表id
         l : number,    // 卡牌等级
         h : number,  // 卡牌血量
         a : number // 卡牌攻击
            },

            // 后续的节点同上
            // 如果某个位子没有放置卡牌则该点为null
            // 长度一定为6
        ]
    },

    e: {
        n: "xixi", // 玩家名
        l: 52, // 玩家等级
        c: [{
                i : number, // 卡牌对应配表id
         l : number,  // 卡牌等级
           h : number,  // 卡牌血量
         a : number // 卡牌攻击
            },

            // 后续的节点同上
            // 如果某个位子没有放置卡牌则该点为null
            // 长度一定为6
        ]
    },

    w: o / e, // 胜利方，己方或敌方

    r: object, // 战斗奖励，具体待定

    s: [{
            a: number, // 出击单位ID号“0～11”，正代表普攻，负代表技能，只有一个出击卡牌
            d: number or array, // 受击单位ID号“0～11”，正代表非暴击，负代表暴击， 可以有多个受击卡牌
            e: number or array, // 受击单位伤害值，0代表闪避，正代表加血，负代表伤害
        },

        // 后续的节点同上
        // 长度不固定
    ]
    }
